{% comment %} <!-- start_trip.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Start Trip</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    <h1>Start a New Trip</h1>
    <form method="POST">
        {% csrf_token %}
        <label for="trip_id">Tanker No.</label>
        <input type="text" class="form-control" id="trip_id" name="trip_id" required>
        <button type="submit" class="btn btn-danger my-3">Start Trip</button>
    </form>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
<!-- @format --> {% endcomment %}

{% include 'base.html' %}
{% load static %}
  <body>
<main id="main" class="main">
      <div class="pagetitle">
        <h1>Add Start Trip</h1>
        <nav>
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'dashboard' %}">Home</a></li>
            <li class="breadcrumb-item active">Dashboard</li>
          </ol>
        </nav>
      </div>
      <!-- End Page Title -->
      <section class="section">
        <div class="row">
          <div class="col-lg-12">
            <div class="card">
              <div class="card-body">
               {% if messages %}
                <div class="container mt-3">
                  {% for message in messages %}
                  <div
                    class="alert alert-info {{ message.tags }} alert-dismissible fade show"
                    role="alert"
                  >
                    <h5 class="text-center">{{ message }}</h5>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="alert"
                      aria-label="Close"
                    ></button>
                  </div>
                  {% endfor %}
                </div>
                {% endif %}
                <h5 class="card-title">Start a New Trip</h5>

    <form method="POST">
     {% csrf_token %}
       {% comment %} <div class="col-lg-4 mb-3">
        <label for="trip_id">Tanker No.</label>
        <input type="text" class="form-control" id="trip_id" name="trip_id" required>
        </div> {% endcomment %}
        <div class="row">
          <div class="col-lg-3 mb-3">
            <label for="trip_id" class="form-label fw-bold">Trip id</label>
             <input type="text" class="form-control"  id="trip_id" name="trip_id"  min="0" step="Trip" required>
             </div>
         <div class="col-lg-3 mb-3">
            <label for="exampleDataList" class="form-label fw-bold">Tanker No</label>
             <input class="form-control" list="datalistOptions" id="tanker" name="tanker"   placeholder="Search to vehicle no..." >
               <datalist id="datalistOptions" class="shadow-sm border-0">
                 {% for v in vehicle %}
                 <option value="{{v.vehicle_name}}">{{v.vehicle_name }}</option>
                 {% endfor %}
                </datalist>
          </div>
          <div class="col-lg-3 mb-3">
            <label for="exampleDataList" class="form-label fw-bold">Drivers Name</label>
             <input class="form-control border-2" list="driverslist" id="exampleDataList" name="drivername" placeholder="Search to drivers...">
               <datalist id="driverslist" class="shadow-sm border-0" >
                  {% for d in dname %}
                 <option value="{{d.name}}"></option>
                {% endfor %}
                </datalist>
             </div>
          <div class="col-lg-3 mb-3">
            <label for="exampleDataList1" class="form-label fw-bold">From Address</label>
             <input class="form-control border-2" name="from_id" list="datalistOptions1" id="exampleDataList1" placeholder="Search to...">
               <datalist id="datalistOptions1">
                {% for c in company %}
                 <option value="{{c.name}}, {{c.short_name}}"></option>
                 {% endfor %}
                </datalist>
          </div>
<div class="col-lg-3 mb-3">
            <label for="exampleDataList2" class="form-label fw-bold">To Address</label>
             <input class="form-control border-2" name="To_id" list="datalistOptions2" id="exampleDataList2" placeholder="Search to...">
               <datalist id="datalistOptions2">
                {% for c in company %}
                 <option value="{{c.name}}, {{c.short_name}}"></option>
                 {% endfor %}
                </datalist>
          </div>
          <div class="col-lg-3 mb-3">
            <label for="label11" class="form-label fw-bold"
              >Trip Date</label
            >
            <input
              type="date"
              name="trip_date"
              class="form-control  border-2"
              id="label11"
            />
          </div>
          <div class="col-lg-3 mb-3">
            <label for="status" class="form-label fw-bold"
              >Pending Trip </label
            >
            <select id="status" name="pending_trip" class="form-control border-2">
            <option value="" selected>Select</option>
            <option value="Empty" >Empty</option>
            <option value="Pending">Pending</option>
            {% comment %} <option value="Add Trip">Add Trip</option> {% endcomment %}
           </select>
          </div>
          <div class="col-lg-3 mb-3">
            <label for="label13" class="form-label fw-bold"
              >Trip Fixed Amount</label
            >
            <input
              type="number"
              name="f_trip"
              class="form-control  border-2"
              id="label13"
              min="0"
              value="0"
             
            />
          </div>
          </div>
        <button type="submit" class="btn btn-success my-3">Start Trip</button>
        <a  class="btn btn-info mx-2" href="{% url 'trip'  %}">View Trip</a>
        
    </form>


</main>
    <!-- End #main -->

    <!-- ======= Footer ======= -->
    <footer id="footer" class="footer">
      <div class="copyright">
        &copy; Copyright <strong>. All Rights Reserved</strong>
      </div>
      <div class="credits">
        Designed by <a href="#"><strong>J N Roadlines</strong></a>
      </div>
    </footer>
    <!-- End Footer -->

    <a
      href="#"
      class="back-to-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>

<div class="col-lg-2 mb-3">
    <label for="trip_id" class="form-label fw-bold">Trip id</label>
    <input type="text" class="form-control" id="trip_id" name="trip_id" required>
</div>

<script>
    // Trip ID ko track karne ke liye localStorage ka use karein
    let serialNumber = localStorage.getItem('serialNumber');

    if (!serialNumber) {
        // Agar serial number nahi hai, to initial value set karein (jaise 1)
        serialNumber = 1;
    } else {
        // Agar serial number hai, to usse increment karein
        serialNumber = parseInt(serialNumber) + 1;
    }

    // Serial number ko zero-padded format mein convert karein (TRIP001, TRIP002, ...)
    let tripId = "TRIP" + serialNumber.toString().padStart(3, '0');

    // Set the trip id in the input field
    document.getElementById('trip_id').value = tripId;

    // Save the updated serial number in localStorage
    localStorage.setItem('serialNumber', serialNumber);
</script>

  </body>
