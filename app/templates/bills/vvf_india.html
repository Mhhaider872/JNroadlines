
<!-- @format -->
{% include 'base.html' %}
{% load static %}


  <body>
    <main id="main" class="main">
      <div class="pagetitle">
        <h1>Dashboard</h1>
        <nav>
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="index.html">Home</a></li>
            <li class="breadcrumb-item active">Dashboard</li>
          </ol>
        </nav>
      </div>
      <!-- End Page Title -->
      {% if messages %}
  <div class="container mt-3">
    {% for message in messages %}
      <div class="alert alert-info {{ message.tags }} alert-dismissible fade show" role="alert">
       <h5 class="text-center"> {{ message }}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  </div>
{% endif %}
      <section class="section">
        <div class="row">
          <div class="col-lg-12">
            <div class="card py-3">
              <div class="card-body">
                </div>
    <section class="main-sec">

  <div class="container">
    <div class="row">
      <div class="col-lg-12 form-div">
<form  method="POST">
 {% csrf_token %}
 <div id="rowContainer">
  <!-- Existing rows will be here -->
  <div class="row">
    
          <div class="col-lg-4 mb-3">
            <label for="label1" class="form-label fw-bold">Bill No</label>
            <input
              type="text"
              class="form-control"
              name="bill_on"
              min="0"
              id="label1"
             disabled
            />
         </div>

        <div class="col-lg-4 mb-3">
            <label for="label2" class="form-label fw-bold">Date</label>
            <input
              type="date"
              class="form-control"
              name="date"
              min="0"
              id="label2"
        
            />
        </div>
         <div class="col-lg-4 mb-3">
            <label for="label3" class="form-label fw-bold">Company Name</label>
            <input
              type="text"
              class="form-control"
              name="company"
              min="0"
              id="label3"
              value="{{bill.company}}"
            />
        </div>
        <div class="col-lg-4 mb-3">
            <label for="label4" class="form-label fw-bold">GST No.</label>
            <input
              type="text"
              class="form-control"
              name="gst"
              min="0"
              id="label4"
               value="{{bill.gst}}"
            />
        </div>
        <div class="col-lg-4 mb-3">
            <label for="label5" class="form-label fw-bold">PAN No.</label>
            <input
              type="text"
              class="form-control"
              name="pan"
              min="0"
              id="label5"
               value="{{bill.pan}}"
            />
        </div>
{% comment %}   
    <div class="col-lg-4 mb-3">
      <label for="tankerNo" class="form-label fw-bold">Tanker No</label>
      <input class="form-control" name="tanker[]" id="tankerNo" placeholder="Tanker No...">
    </div>
    <div class="col-lg-4 mb-3">
      <label for="fromAddress" class="form-label fw-bold">From Address</label>
      <input class="form-control" name="from_address[]" id="fromAddress" placeholder="From Address...">
    </div>
    <div class="col-lg-4 mb-3">
      <label for="toAddress" class="form-label fw-bold">To Address</label>
      <input class="form-control" name="to_address[]" id="toAddress" placeholder="To Address...">
    </div>
 <div class="col-lg-4 mb-3">
            <label for="date_dis" class="form-label fw-bold"
              >Dispatch date </label
            >
            <input
              type="date"
              name="date_dis"
              name="date_dis[]"
              class="form-control"
              id="date_dis"
            />
          </div> {% endcomment %}
           {% comment %} <div class="col-lg-4 mb-3">
            <label for="tanker_cap" class="form-label fw-bold"
              >Tanker Capacity ( K.G )</label
            >
            <input
           
              class="form-control"
              name="tanker_cap[]"
              min="0"
              id="tanker_cap"
              value="{{tank_capacity}}"
              
            />
          </div>
       
         
              <div class="col-lg-4 mb-3">
            <label for="lr_num" class="form-label fw-bold">LR No </label>
            <input
              type="number"
              class="form-control"
              name="lr_num[]"
              min="0"
              id="lr_num"
              value="{{lr_num}}"
            />
        </div> {% endcomment %}

        
        
        
   
      
         {% comment %} <div class="col-lg-4 mb-3">
            <label for="label19" class="form-label fw-bold"
              >Freight Bill no.</label
            >
            <input
              type="number"
              name="freight_bill"
              class="form-control"
              id="label19"
               min="0"
            />
        </div> {% endcomment %}
      
        {% comment %} <div class="col-lg-4 mb-3">
            <label for="disqty" class="form-label fw-bold">Loaded Qty  ( K.G )</label>
            <input type="number" class="form-control" id="kg" name="load[]" value="{{loaded_qty}}"  oninput="calculateTotal()">
        </div> {% endcomment %}
        {% comment %} <div class="col-lg-4 mb-3">
            <label for="label13" class="form-label fw-bold">Allow Percentage</label>
            <input type="number" class="form-control" id="percente" name="percent" value="{{t.totalshort}}" oninput="calculateTotalShort()" step="0.01">
        </div> {% endcomment %}
          {% comment %} <div class="col-lg-4 mb-3">
            <label for="label13" class="form-label fw-bold">Unloaded Qty  ( K.G )</label>
            <input type="number" class="form-control" id="unlodqty" name="unload" value="{{unload_qty}}" oninput="calculateTotalShort()">
        </div> {% endcomment %}
     
{% comment %}        
         <div class="col-lg-4 mb-3">
            <label for="rate_kg" class="form-label fw-bold">Rate Per( K.G )</label>
            <input
              type="number"
              class="form-control"
              name="return_qty[]"
              min="0"
              id="rate"
              oninput="calculateTotal()"
            />
        </div>
        <div class="col-lg-4 mb-3">
            <label for="totalamount" class="form-label fw-bold">Total</label>
            <input
              type="number"
              class="form-control"
              name="return_qty[]"
              min="0"
              id="totalamount"
              oninput="calculateTotal()"
            />
        </div> {% endcomment %}


    
  </div>
</div>
<!-- Button to Add Row -->
<button type="button" class="btn btn-primary" onclick="addRow()">Add Row</button>
 <hr>
         
        <div class="row">
  {% comment %} <h5>Detention Charge</h5>
        <div class="col-lg-4 mb-3">
            <label for="label5" class="form-label fw-bold"
              >From </label
            >
            <input
              type="date"
              name="Fo_date"
              class="form-control"
              id="Fo_date"
            />
        </div>
         <div class="col-lg-4 mb-3">
            <label for="label5" class="form-label fw-bold"
              >To</label
            >
            <input
              type="date"
              name="To_date"
              class="form-control"
              id="To_date"
            />
        </div>
         <div class="col-lg-4 mb-3">
            <label for="label18" class="form-label fw-bold">Rate </label>
            <input
              type="number"
              class="form-control"
              name="d_rate"
              min="0"
              id="perrate"
              oninput="Total()"
            />
        </div>
        <div class="col-lg-4 mb-3">
            <label for="label19" class="form-label fw-bold"> Per Day</label>
            <input
              type="number"
              class="form-control"
              name="par_day"
              min="0"
              id="day"
              oninput="Total()"
            />
        </div>
     
         <div class="col-lg-4 mb-3">
            <label for="label20" class="form-label fw-bold"
              >Total</label
            >
            <input
              type="number"
              name="total_d"
              class="form-control"
              id="totals"
               
               oninput="Total()"
               min="0"
               readonly
            />
        </div>
        <div class="col-lg-4 mb-3">
            <label for="tank_c" class="form-label fw-bold"
              >Tanker Washing Charges</label
            >
            <input
              type="number"
              name="tank_c"
              class="form-control"
              id="tank_c"
               min="0"
             
            />
        </div> {% endcomment %}

        </div>

      
          
       
        <div class="btn-div text-center py-2">
            <button type="submit" class="btn btn-danger px-4 mx-2">Save</button>
            <a href="{% url 'show-ashland' %}" class="btn btn-success px-4 mx-2">View</a>
            <a href="{% url 'ash-bill' %}" class="btn btn-info text-white px-4 mx-2">Create Bill</a>
        </div>
        </form>
      </div>
    </div>
  </div>
</section>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
    <!-- End #main -->

    <!-- ======= Footer ======= -->
    <footer id="footer" class="footer">
      <div class="copyright">
        &copy; Copyright <strong>. All Rights Reserved</strong>
      </div>
      <div class="credits">
        Designed by <a href="#"><strong>J N Roadlines</strong></a>
      </div>
    </footer>
    <!-- End Footer -->

    <a
      href="#"
      class="back-to-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>
{% comment %} <script>
        function calculateTotalShort() {
            // Get the values of disqty and unlodqty from the form
            var disqty = document.getElementById("disqty").value;
            var unlodqty = document.getElementById("unlodqty").value;


            // Calculate totalshort only if both values are numbers
            if (disqty && unlodqty) {
                var totalshort = parseInt(disqty) - parseInt(unlodqty);
                document.getElementById("totalshort").value = totalshort; // Display totalshort in the input field
            }
        }
    </script> {% endcomment %}
  <script>
    function Total() {
        // Get the values of the input fields by their IDs
        let perrate = parseFloat(document.getElementById('perrate').value);
        let day = parseFloat(document.getElementById('day').value);

        // If either kg or rate is NaN (not a number), don't calculate the total
        if (isNaN(perrate) || isNaN( day)) {
            document.getElementById('totals').value = ''; // Clear the total field if invalid input
        } else {
            let total = perrate * day;
            document.getElementById('totals').value = total; // Display the total in the input field
        }
    }
</script>
<script>
// Function to calculate the total for each row
function calculateTotal(row) {
    // Get the values of the input fields by their class names for the specific row
    let kg = parseFloat(row.querySelector('.kg').value);
    let rate = parseFloat(row.querySelector('.rate').value);

    // If either kg or rate is NaN (not a number), don't calculate the total
    if (isNaN(kg) || isNaN(rate)) {
        row.querySelector('.totalamount').value = ''; // Clear the total field if invalid input
    } else {
        let total = kg * rate;
        row.querySelector('.totalamount').value = total; // Display the total in the input field
    }
}

// Function to add a new row dynamically
function addRow() {
    const rowContainer = document.getElementById('rowContainer');
    
    // Create a new row
    const newRow = document.createElement('div');
    newRow.classList.add('row');
    
    newRow.innerHTML = `

      <div class="col-lg-4 mb-3">
        <label for="tankerNo" class="form-label fw-bold">Tanker No</label>
          <input class="form-control border-2" name="tanker" list="datalistOptions" id="exampleDataList" placeholder="Search to vehicle no...">
               <datalist id="datalistOptions" class="shadow-sm border-0" >
                {% for v in vehicle %}
                 <option value="{{v.vehicle_name}}">{{v.vehicle_name }}</option>
                 {% endfor %}
                </datalist>
        {% comment %} <input class="form-control tankerNo" name="tanker" placeholder="Tanker No..."> {% endcomment %}
      </div>
      <div class="col-lg-4 mb-3">
        <label for="fromAddress" class="form-label fw-bold">From Address</label>
        <input class="form-control border-2" name="From_add" list="datalistOptions1" id="exampleDataList1" placeholder="Search to...">
               <datalist id="datalistOptions1" class="shadow-sm border-0" >
                {% for c in company %}
                 <option value="{{c.name}}, {{c.city}}"></option>
                 {% endfor %}
                </datalist>
        {% comment %} <input class="form-control fromAddress" name="from_address[]" placeholder="From Address..."> {% endcomment %}
      </div>
      <div class="col-lg-4 mb-3">
        <label for="toAddress" class="form-label fw-bold">To Address</label>
          <input class="form-control border-2" name="To_add" list="datalistOptions2" id="exampleDataList2" placeholder="Search to...">
               <datalist id="datalistOptions2" class="shadow-sm border-0" >
                {% for c in company %}
                 <option value="{{c.name}}, {{c.city}}"></option>
                 {% endfor %}
                </datalist>
        {% comment %} <input class="form-control toAddress" name="to_address[]" placeholder="To Address..."> {% endcomment %}
      </div>
       <div class="col-lg-4 mb-3">
            <label for="date_dis" class="form-label fw-bold">Dispatch date </label>
            <input type="date" name="date_dis" class="form-control" />
        </div>
       <div class="col-lg-4 mb-3">
            <label for="tanker_cap" class="form-label fw-bold">Tanker Capacity ( K.G )</label>
            <input class="form-control tanker_cap" name="tanker_cap" min="0" />
        </div>
        <div class="col-lg-4 mb-3">
            <label for="lr_num" class="form-label fw-bold">LR No </label>
            <input type="number" class="form-control" name="lr_num" />
        </div>
        <div class="col-lg-4 mb-3">
            <label for="disqty" class="form-label fw-bold">Loaded Qty  ( K.G )</label>
            <input type="number" class="form-control kg" name="kg" value="{{loaded_qty}}" oninput="calculateTotal(this.closest('.row'))">
        </div>
        <div class="col-lg-4 mb-3">
            <label for="rate_kg" class="form-label fw-bold">Rate Per ( K.G )</label>
            <input type="number" class="form-control rate" name="rate" oninput="calculateTotal(this.closest('.row'))" />
        </div>
        <div class="col-lg-4 mb-3">
            <label for="totalamount" class="form-label fw-bold">Total</label>
            <input type="number" class="form-control totalamount" name="total_kg" readonly />
        </div>
    `;

    // Append the new row to the container
    rowContainer.appendChild(newRow);
}

</script>

  </body>

